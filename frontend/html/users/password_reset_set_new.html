{% extends "layout.html" %}

{% block content %}
    <div class="content">
        <div class="content-form">

            <div class="form-title">Set New Password</div>

            {# Display messages #}
            {% if messages %}
                {% include "includes/message_form.html" %}
            {% endif %}

            {% if validlink %}
                <form method="post">
                    {% csrf_token %}

                    {# Display non-field errors #}
                    {% if form.non_field_errors %}
                        <div class="errors">
                            {{ form.non_field_errors }}
                        </div>
                    {% endif %}

                    {# New password field #}
                    <div>
                        {{ form.new_password1.label_tag }}
                        {{ form.new_password1 }}
                        {% if form.new_password1.errors %}
                            <div class="errors">{{ form.new_password1.errors }}</div>
                        {% endif %}
                    </div>

                    {# Confirm new password field #}
                    <div>
                        {{ form.new_password2.label_tag }}
                        {{ form.new_password2 }}
                        {% if form.new_password2.errors %}
                            <div class="errors">{{ form.new_password2.errors }}</div>
                        {% endif %}
                    </div>

                    <button type="submit" class="button btn-form">
                        Reset Password
                    </button>
                </form>
            {% else %}
                <div class="text-align-center">
                    <p>
                        Invalid or expired password reset link.
                    </p>
                    <p>
                        Possibly because it has already been used or has expired.
                    </p>
                </div>
                <div class="text-align-center">
                    <a href="{% url 'password_reset_request' %}" class="link">Request a new reset link</a>
                </div>
            {% endif %}

        </div>
    </div>
{% endblock %}
